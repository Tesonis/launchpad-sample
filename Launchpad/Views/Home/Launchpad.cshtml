
@{
    ViewBag.Title = "Launchpad Home";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Name = Request.Cookies["SecToken"]["FullName"];
    ViewBag.role = Request.Cookies["SecToken"]["Role"];
}
@model Launchpad.Models.HomeViewModels.LaunchpadViewModel
@Styles.Render("~/Content/bs-select")
@Styles.Render("~/Content/css")
@Styles.Render("~/Content/Site.css")
<link href="~/Content/Site.css" rel="stylesheet" />
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item active" aria-current="page"><h5 class="text-muted">Launchpad</h5></li>
    </ol>
</nav>
<div class="py-2">
    <div class="row">
        <div class="col-12">
            <section id="section_dash">
                <section id="section_error"></section>
                @if (ViewBag.role == "Brand" || ViewBag.role == "Admin")
                {
                    <section id="section_review" class="mb-4 p-3 bg-white border">
                        <div class="p-3 d-flex align-items-center">
                            <i class="fa fa-exclamation bg-warning p-3 font-2xl mr-3"></i>
                            <div class="text-value-sm text-warning">Action Required</div>
                        </div>
                        <div id="alert-task" class="alert">
                            You have <span class="alert-link"></span> outstanding tasks. <a href="#?" id="btn-alerttaskexpand">Click here to View</a>
                        </div>
                        <div id="div-tasks" style="display:none; width:100% !important;">
                            <table class="table table-bordered datatable " id="table-tasks">
                                <thead class="thead-light">
                                    <tr>
                                        <th width="100">Item #</th>
                                        <th>Item Description</th>
                                        <th>Item Size</th>
                                        <th hidden>Brandcode</th>
                                        <th>Brand</th>
                                        <th hidden>customercode</th>
                                        <th>Account</th>
                                        <th hidden>bannercode</th>
                                        <th>Banner</th>
                                        <th>Status</th>
                                        <th>Created On</th>
                                        <th hidden>createduser</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </section>
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body ">
                                    <div class="p-3 d-flex align-items-center">
                                        <i class="fa fa-barcode bg-primary p-3 font-2xl mr-3"></i>
                                        <div class="text-value-sm text-primary">Launch Items</div>
                                        <a href="@Url.Action("LaunchBDM", null, new { a = "create", controller = "Home", step = 1 }, Request.Url.Scheme)" class="btn btn-lg btn-primary ml-auto">Launch New</a>
                                        <a href="@Url.Action("LaunchBDM", null, new { a = "update", controller = "Home", step = 1  }, Request.Url.Scheme)" class="btn btn-lg btn-outline-primary ml-3">Update Existing</a>
                                    </div>
                                    <hr />
                                    <div id="alert-bdminprogress" class="alert alert-primary">
                                        You have <span></span> launches in progress. <a href="#?" class="alert-link" id="btn-alertbdmexpand">Click to View</a>
                                    </div>
                                    <div id="div-tablebdm" style="display:none">
                                        <table class="table table-bordered datatable" id="table-bdm">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th width="100">Item #</th>
                                                    <th>Item Description</th>
                                                    <th>Item Size</th>
                                                    <th hidden>Brandcode</th>
                                                    <th>Brand</th>
                                                    <th hidden>customercode</th>
                                                    <th>Account</th>
                                                    <th hidden>bannercode</th>
                                                    <th>Banner</th>
                                                    <th>Status</th>
                                                    <th>Created On</th>
                                                    <th hidden>createduser</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                }
                @if (ViewBag.role == "Sales" || ViewBag.role == "Admin")
                {
                    <section id="section_review_cdm" class="mb-4 p-3 bg-white border">
                        <div class="p-3 d-flex align-items-center">
                            <i class="fa fa-exclamation bg-warning p-3 font-2xl mr-3"></i>
                            <div>
                                <div class="text-value-sm text-warning">Action Required</div>
                                @*<div class="text-muted text-uppercase font-weight-bold small">Income</div>*@
                            </div>
                        </div>
                        <div id="alert-task" class="alert">
                            You have <span class="alert-link"></span> outstanding tasks. <a href="#?" id="btn-alerttaskexpand-cdm">Click here to View</a>
                        </div>
                        <div id="div-tasks-cdm" style="display:none; width:100% !important;">
                            <table class="table table-bordered datatable " id="table-tasks-cdm">
                                <thead class="thead-light">
                                    <tr>
                                        <th width="100">Item #</th>
                                        <th>Item Description</th>
                                        <th>Item Size</th>
                                        <th hidden>Brandcode</th>
                                        <th>Brand</th>
                                        <th hidden>customercode</th>
                                        <th>Account</th>
                                        <th hidden>bannercode</th>
                                        <th>Banner</th>
                                        <th>Status</th>
                                        <th>Created On</th>
                                        <th hidden>createduser</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>

                    </section>
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body ">
                                    <div class="p-3 d-flex align-items-center">
                                        <i class="fa fa-handshake-o bg-success p-3 font-2xl mr-3"></i>
                                        <div>
                                            <div class="text-value-sm text-success">Launch Action / Update</div>
                                        </div>
                                        <a href="@Url.Action("LaunchCDM", null, new { a = "launch", controller = "Home" }, Request.Url.Scheme)" class="btn btn-lg btn-success ml-auto">Launch New</a>
                                        <a href="@Url.Action("LaunchCDM", null, new { a = "update", controller = "Home" }, Request.Url.Scheme)" class="btn btn-lg btn-outline-success ml-3">Update Existing</a>
                                    </div>
                                    <hr />
                                    <div id="alert-cdminprogress" class="alert alert-primary">
                                        You have <span></span> launches in progress. <a href="#?" class="alert-link" id="btn-alertcdmexpand">Click to View</a>
                                    </div>
                                    <div id="div-tablecdm" style="display:none">
                                        <table class="table table-bordered datatable" id="table-cdm">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th width="100">Item #</th>
                                                    <th>Item Description</th>
                                                    <th>Item Size</th>
                                                    <th hidden>Brandcode</th>
                                                    <th>Brand</th>
                                                    <th hidden>customercode</th>
                                                    <th>Account</th>
                                                    <th hidden>bannercode</th>
                                                    <th>Banner</th>
                                                    <th>Status</th>
                                                    <th>Created On</th>
                                                    <th hidden>createduser</th>
                                                </tr>
                                            </thead>
                                            <tbody></tbody>
                                        </table>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>
                }

                @{
                    Html.RenderPartial("_ItemRecord");
                }
            </section>
            <span id="anchor_pricechange" />
            @*@{
                Html.RenderPartial("_LaunchpadReport");
            }*@

        </div>
    </div>
</div>
@section Scripts{
    <script src="~/Scripts/Chart.min.js"></script>
    <script src="~/Scripts/Site/Dashboard.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {


            var role = @Html.Raw(Json.Encode(@ViewBag.role));
            if (role == "Admin")
            {
                GetBDMTaskList();
                GetBDMInprogressList();
                GetCDMTaskList();
                GetCDMInprogressList();
            }
             else if (role == "Brand")
             {
                 GetBDMTaskList();
                 GetBDMInprogressList();
            }
            else if (role == "Sales"){
                GetCDMTaskList();
                GetCDMInprogressList();
            }
            ListBrandsbyBDM();
            GetKeyAccountsDDL();
            ListLaunchStatus();
            $("#btn-alerttaskexpand").on('click', function () {
                $("#div-tasks").show();
            })
            $("#btn-alerttaskexpand-cdm").on('click', function () {
                $("#div-tasks-cdm").show();
            })
            $("#btn-alertbdmexpand").on('click', function () {
                $("#div-tablebdm").show();
            })
            $("#btn-alertcdmexpand").on('click', function () {
                $("#div-tablecdm").show();
            })
            $("#summary-total").text(summarytotalsku().toString());
            calcpercsummary();

            var ctx = document.getElementById('chart-summary-all').getContext('2d');
            window.myPie = new Chart(ctx, config);
            //Chart 2
            var ctx1 = document.getElementById('chart-summary-account').getContext('2d');
            window.myBar = new Chart(ctx1, {
                type: 'horizontalBar',
                data: barChartData,
                options: {
                    title: {
                        display: true,
                        text: 'In Progress SKUs by Account'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: false
                    },
                    responsive: true,
                    scales: {
                        xAxes: [{
                            stacked: true,
                        }],
                        yAxes: [{
                            stacked: true
                        }]
                    }
                }
            });
            //Chart 3
            var ctx2 = document.getElementById('chart-summary-sku').getContext('2d');
            window.myBar = new Chart(ctx2, {
                type: 'horizontalBar',
                data: barChartDataSKU,
                options: {
                    title: {
                        display: true,
                        text: 'SKU Timeline'
                    },
                    tooltips: {
                        mode: 'index',
                        intersect: false
                    },
                    responsive: true,
                    scales: {
                        xAxes: [{
                            stacked: true,
                        }],
                        yAxes: [{
                            stacked: true
                        }]
                    }
                }
            });


        });
        
        function calcpercsummary() {
            var total = parseInt($("#summary-total").text());
            for (i = 0; i < 7; i++) {
                $(".summaryperc").eq(i).text((parseInt($(".summarydata").eq(i).text()) / total * 100).toFixed(2) + "%");
            }
        }
        function showinprogressBDM() {
            $("#div-tablebdm").show();
        }
        function showinprogressCDM() {
            $("#div-tablecdm").show();
        }
        function createitemreport() {
            $("#div-itemreport").show();
            GetLaunches();
        }
        function reportsummary() {
            $(".modal").modal('hide');
            $("#report section").hide();
            $("#reportsummary").show();
            $("#reportgroupaccount").show();
        }
        function reportaccountbrand() {
            $(".modal").modal('hide');
            $("#report section").hide();
            $("#reportacountdetails").show();
        }
        function reportaccountbrandmodal() {
            $(".modal").modal('hide');
            $("#report section").hide();
            $("#reportacountdetails").show();
        }
        function reportitem() {
            $(".modal").modal('hide');
            $("#report section").hide();
            $("#reportitemaccounts").show();
        }
    </script>
    <!--AJAX Get-->
    <script>

        function GetLaunches() {
            var role = @Html.Raw(Json.Encode(@ViewBag.role));
            if (role == "Brand") {
                var url = '@Url.Action("ListBDMLaunches", "Home")';
            }
            if (role == "Sales") {
                var url = '@Url.Action("ListCDMLaunches", "Home")';
            }
            $('#table-report').DataTable().destroy();
            $("#table-report tbody").html("");
            var brand = $("#select-brand").val();
            var kac = $("#select-kac-item").val();
            var banner = $("#select-banner").val();
            var statuslist = $("#select_item_launchstatus").val();

            $.ajax({
                type: "GET",
                url: url,
                dataType: 'JSON',
                data: {src:'report', brand:brand, kac:kac, banner:banner, statusjson: JSON.stringify(statuslist) },
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());

                        //Create option for each brand retrieved
                        for (i = 0; i < responseArr.length; i++) {
                            var rowhtml = "<tr>";
                            rowhtml += "<td hidden>" + responseArr[i].LaunchID + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemnumber + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].BDM + "</td>";
                            rowhtml += "<td>" + responseArr[i].Brandname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].CDM + "</td>";
                            rowhtml += "<td>" + responseArr[i].Customeraccname + "</td>";
                            rowhtml += "<td>" + responseArr[i].Bannername + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemdesc + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemsize + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].CaseUPC + "</td>";
                            rowhtml += "<td>" + responseArr[i].Launchdate + "</td>";
                            switch (responseArr[i].Status) {
                                case "N/A":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> N/A</td>";
                                    break;
                                case "Do Not Present":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> Do Not Present</td>";
                                    break;
                                case "Discussion Required":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> Discussion Required</td>";
                                    break;
                                case "Ready to Present":
                                    rowhtml += "<td><i class='fa fa-square text-secondary'></i> Ready to Present</td>";
                                    break;
                                case "VOR Change Initiated":
                                    rowhtml += "<td><i class='fa fa-square text-muted'></i> VOR Change Initiated</td>";
                                    break;
                                case "Vor Change Complete":
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Vor Change Complete</td>";
                                    break;
                                case "Initial Contact":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Contact</td>";
                                    break;
                                case "Initial Meeting":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Meeting</td>";
                                    break;
                                case "Launch Package Sent":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Launch Package Sent</td>";
                                    break;
                                case "Pending":
                                    rowhtml += "<td><i class='fa fa-square text-primary'></i> Pending</td>";
                                    break;
                                case "Declined by Client":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Client</td>";
                                    break;
                                case "Declined by Retailer":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Retailer</td>";
                                    break;
                                default:
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Accepted</td>";
                                    break;
                            }
                            rowhtml += "<td hidden>" + responseArr[i].Followup + "</td>";
                            rowhtml += "<td hidden></td>";//comments
                            rowhtml += "<td hidden>" + responseArr[i].Productcategory + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Pogreview + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Pogdrop + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Categorycomment + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Competitive + "</td>";

                            rowhtml += "</tr>"
                            $("#table-report tbody").append(rowhtml);
                        }

                        $("#table-report").dataTable({
                            dom: 'Bfrtip',
                            buttons: [
                                'excel'
                            ],
                            responsive: true,
                            "columnDefs": [
                                { "orderable": false, "targets": [8, 12] }
                            ],
                            "order": [[0, "asc"]]
                        });
                        $("#table-report").removeAttr('style');
                    }
                },
                error: function (request, status, error) {
                    alert('Error occured');
                    alert(request.responseText);
                }
            });
        }
        function GetBDMTaskList() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("ListBDMLaunches", "Home")',
                dataType: 'JSON',
                data: {src: "task"},
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());
                        if (responseArr.length == 0) {
                            $("#section_review #alert-task").removeClass();
                            $("#section_review #alert-task").addClass("alert alert-success");
                        }
                        else {
                            $("#section_review #alert-task").removeClass();
                            $("#section_review #alert-task").addClass("alert alert-warning");
                        }
                        $("#section_review #alert-task .alert-link").text(responseArr.length);
                        //Create option for each brand retrieved
                        for (i = 0; i < responseArr.length; i++) {
                            var rowhtml = "<tr>";
                            rowhtml += "<td>" + responseArr[i].Itemnumber + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemdesc + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemsize + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Brandcode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Brandname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Customeracccode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Customeraccname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Bannercode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Bannername + "</td>";
                            
                            switch (responseArr[i].Status) {
                                case "N/A":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> N/A</td>";
                                    break;
                                case "Discussion Required":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> Discussion Required</td>";
                                    break;
                                case "Ready to Present":
                                    rowhtml += "<td><i class='fa fa-square text-secondary'></i> Ready to Present</td>";
                                    break;
                                case "VOR Change Initiated":
                                    rowhtml += "<td><i class='fa fa-square text-muted'></i> VOR Change Initiated</td>";
                                    break;
                                case "Vor Change Complete":
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Vor Change Complete</td>";
                                    break;
                                case "Initial Contact":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Contact</td>";
                                    break;
                                case "Initial Meeting":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Meeting</td>";
                                    break;
                                case "Launch Package Sent":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Launch Package Sent</td>";
                                    break;
                                case "Pending":
                                    rowhtml += "<td><i class='fa fa-square text-primary'></i> Pending</td>";
                                    break;
                                case "Declined By Client":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Client</td>";
                                    break;
                                case "Declined By Retailer":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Retailer</td>";
                                    break;
                                default:
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Accepted</td>";
                                    break;
                            }
                            rowhtml += "<td>" + responseArr[i].Launchdate + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Launchuser + "</td>";
                            rowhtml += "</tr>"
                            $("#table-tasks tbody").append(rowhtml);
                        }

                        //Create datatable
                        $('#table-tasks').dataTable({
                            "columnDefs": [
                                {"orderable": true},
                            ],
                            "searching": false,
                            "order": [[0, "asc"]],
                            "lengthChange": false
                        });
                        $("#table-tasks").removeAttr('style');
                    }
                },
                error: function (request, status, error) {
                    alert('Error occured - BDM TASKS');
                    alert(request.responseText);
                }
            });
        }
        function GetBDMInprogressList() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("ListBDMLaunches", "Home")',
                dataType: 'JSON',
                data: {src: "inprogress"},
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());
                        $("#alert-bdminprogress span").text(responseArr.length);
                        if (responseArr.length == 0) {
                            $("#btn-alertbdmexpand").hide();
                        }

                        //Create option for each brand retrieved
                        for (i = 0; i < responseArr.length; i++) {
                            var rowhtml = "<tr>";
                            rowhtml += "<td>" + responseArr[i].Itemnumber + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemdesc + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemsize + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Brandcode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Brandname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Customeracccode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Customeraccname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Bannercode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Bannername + "</td>";

                            switch (responseArr[i].Status) {
                                case "N/A":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> N/A</td>";
                                    break;
                                case "Discussion Required":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> Discussion Required</td>";
                                    break;
                                case "Ready to Present":
                                    rowhtml += "<td><i class='fa fa-square text-secondary'></i> Ready to Present</td>";
                                    break;
                                case "VOR Change Initiated":
                                    rowhtml += "<td><i class='fa fa-square text-muted'></i> VOR Change Initiated</td>";
                                    break;
                                case "Vor Change Complete":
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Vor Change Complete</td>";
                                    break;
                                case "Initial Contact":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Contact</td>";
                                    break;
                                case "Initial Meeting":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Meeting</td>";
                                    break;
                                case "Launch Package Sent":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Launch Package Sent</td>";
                                    break;
                                case "Pending":
                                    rowhtml += "<td><i class='fa fa-square text-primary'></i> Pending</td>";
                                    break;
                                case "Declined By Client":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Client</td>";
                                    break;
                                case "Declined By Retailer":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Retailer</td>";
                                    break;
                                default:
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Accepted</td>";
                                    break;
                            }
                            rowhtml += "<td>" + responseArr[i].Launchdate + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Launchuser + "</td>";
                            rowhtml += "</tr>"
                            $("#table-bdm tbody").append(rowhtml);
                        }

                        //Create datatable
                        $('#table-bdm').dataTable({
                            "columnDefs": [
                                {"orderable": true},
                            ],
                            "searching": false,
                            "order": [[0, "asc"]],
                            "lengthChange": false
                        });
                        $("#table-bdm").removeAttr('style');
                    }
                },
                error: function (request, status, error) {
                    alert('Error occured');
                    alert(request.responseText);
                }
            });
        }
        function GetCDMTaskList() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("ListCDMLaunches", "Home")',
                dataType: 'JSON',
                data: {src: "task"},
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());
                        if (responseArr.length == 0) {
                            $("#section_review_cdm #alert-task").removeClass();
                            $("#section_review_cdm #alert-task").addClass("alert alert-success");
                        }
                        else {
                            $("#section_review_cdm #alert-task").removeClass();
                            $("#section_review_cdm #alert-task").addClass("alert alert-warning");
                        }
                        $("#section_review_cdm #alert-task .alert-link").text(responseArr.length);
                        //Create option for each brand retrieved
                        for (i = 0; i < responseArr.length; i++) {
                            var rowhtml = "<tr>";
                            rowhtml += "<td>" + responseArr[i].Itemnumber + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemdesc + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemsize + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Brandcode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Brandname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Customeracccode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Customeraccname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Bannercode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Bannername + "</td>";

                            switch (responseArr[i].Status) {
                                case "N/A":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> N/A</td>";
                                    break;
                                case "Discussion Required":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> Discussion Required</td>";
                                    break;
                                case "Ready to Present":
                                    rowhtml += "<td><i class='fa fa-square text-secondary'></i> Ready to Present</td>";
                                    break;
                                case "VOR Change Initiated":
                                    rowhtml += "<td><i class='fa fa-square text-muted'></i> VOR Change Initiated</td>";
                                    break;
                                case "Vor Change Complete":
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Vor Change Complete</td>";
                                    break;
                                case "Initial Contact":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Contact</td>";
                                    break;
                                case "Initial Meeting":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Meeting</td>";
                                    break;
                                case "Launch Package Sent":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Launch Package Sent</td>";
                                    break;
                                case "Pending":
                                    rowhtml += "<td><i class='fa fa-square text-primary'></i> Pending</td>";
                                    break;
                                case "Declined By Client":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Client</td>";
                                    break;
                                case "Declined By Retailer":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Retailer</td>";
                                    break;
                                default:
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Accepted</td>";
                                    break;
                            }
                            rowhtml += "<td>" + responseArr[i].Launchdate + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Launchuser + "</td>";
                            rowhtml += "</tr>"
                            $("#section_review_cdm #table-tasks-cdm tbody").append(rowhtml);
                        }

                        //Create datatable
                        $('#section_review_cdm #table-tasks-cdm').dataTable({
                            "columnDefs": [
                                {"orderable": true},
                            ],
                            "searching": false,
                            "order": [[0, "asc"]],
                            "lengthChange": false
                        });
                        $("#section_review_cdm #table-tasks-cdm").removeAttr('style');
                    }
                },
                error: function (request, status, error) {
                    alert('Error occured');
                    alert(request.responseText);
                }
            });
        }
        function GetCDMInprogressList() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("ListCDMLaunches", "Home")',
                dataType: 'JSON',
                data: {src: "inprogress"},
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());
                        $("#alert-cdminprogress span").text(responseArr.length);
                        if (responseArr.length == 0) {
                            $("#btn-alertcdmexpand").hide();
                        }

                        //Create option for each brand retrieved
                        for (i = 0; i < responseArr.length; i++) {
                            var rowhtml = "<tr>";
                            rowhtml += "<td>" + responseArr[i].Itemnumber + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemdesc + "</td>";
                            rowhtml += "<td>" + responseArr[i].Itemsize + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Brandcode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Brandname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Customeracccode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Customeraccname + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Bannercode + "</td>";
                            rowhtml += "<td>" + responseArr[i].Bannername + "</td>";

                            switch (responseArr[i].Status) {
                                case "N/A":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> N/A</td>";
                                    break;
                                case "Discussion Required":
                                    rowhtml += "<td><i class='fa fa-square text-dark'></i> Discussion Required</td>";
                                    break;
                                case "Ready to Present":
                                    rowhtml += "<td><i class='fa fa-square text-secondary'></i> Ready to Present</td>";
                                    break;
                                case "VOR Change Initiated":
                                    rowhtml += "<td><i class='fa fa-square text-muted'></i> VOR Change Initiated</td>";
                                    break;
                                case "Vor Change Complete":
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Vor Change Complete</td>";
                                    break;
                                case "Initial Contact":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Contact</td>";
                                    break;
                                case "Initial Meeting":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Initial Meeting</td>";
                                    break;
                                case "Launch Package Sent":
                                    rowhtml += "<td><i class='fa fa-square text-info'></i> Launch Package Sent</td>";
                                    break;
                                case "Pending":
                                    rowhtml += "<td><i class='fa fa-square text-primary'></i> Pending</td>";
                                    break;
                                case "Declined By Client":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Client</td>";
                                    break;
                                case "Declined By Retailer":
                                    rowhtml += "<td><i class='fa fa-square text-danger'></i> Declined By Retailer</td>";
                                    break;
                                default:
                                    rowhtml += "<td><i class='fa fa-square text-success'></i> Accepted</td>";
                                    break;
                            }
                            rowhtml += "<td>" + responseArr[i].Launchdate + "</td>";
                            rowhtml += "<td hidden>" + responseArr[i].Launchuser + "</td>";
                            rowhtml += "</tr>"
                            $("#table-cdm tbody").append(rowhtml);
                        }

                        //Create datatable
                        $('#table-cdm').dataTable({
                            "columnDefs": [
                                { "orderable": true }
                            ],
                            "order": [[0, "asc"]],
                            "lengthChange": false
                        });
                        $("#table-cdm").removeAttr('style');
                    }
                },
                error: function (request, status, error) {
                    alert('Error occured');
                    alert(request.responseText);
                }
            });
        }
        function ListBrandsbyBDM() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("ListBrandsbyBDM", "Home")',
                dataType: 'JSON',
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());
                        //Create default selection
                        $("#select-brand").append('<option value= "" selected="true">--- All Brands ---</option>');
                        //Create option for each brand retrieved
                        for (var i = 0; i < responseArr.length; i++) {
                            $("#select-brand").append('<option value= "' + responseArr[i].Value + '">' + responseArr[i].Text + '</option>');
                        }
                        //Refresh bootstrap select to display new options
                        $("#select-brand").selectpicker("refresh");

                    }
                },
                error: function () {
                    $("#section_error").html(RenderError("-1", "Unexpected Error", "BDM Brand List"));
                }
            });
        }
        function GetKeyAccountsDDL() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("GetKeyAccounts", "Home")',
                dataType: 'JSON',
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());
                        $("#select-kac-item").append('<option value= "" selected="true">All  Customer Accounts</option>');
                        //Create option for each retrieved
                        for (var i = 0; i < responseArr.length; i++) {
                            $("#select-kac-item").append('<option value= "' + responseArr[i].AccountCode + '">' + responseArr[i].AccountName + '</option>');
                        }
                        $("#select-kac-item").selectpicker("refresh");
                    }
                },
                error: function (request, status, error) {
                    alert('Error occured');
                    alert(request.responseText);
                }
            });
        }
        $('#select-kac-item').change(function () {
            $("#select-banner").empty();
            var data = $(this).val().toString();

            $.ajax({
                type: "GET",
                url: '@Url.Action("GetBannerFromAcc", "Home")',
                dataType:'JSON',
                data: { kac: data},
                success: function (response) {
                    var responseArr = JSON.parse(response.toString());
                    $("#select-banner").append('<option value= "" selected="true">All</option>');
                    //Create option for each retrieved
                    for (var i = 0; i < responseArr.length; i++) {
                        $("#select-banner").append('<option value= "' + responseArr[i].Value + '">' + responseArr[i].Text + '</option>');
                    }
                    $("#select-banner").selectpicker("refresh");
                },
                error: function (request, status, error) {
                    alert('Error occured');
                    alert(request.responseText);
                }
            });
        });
        function ListLaunchStatus() {
            $.ajax({
                type: "GET",
                url: '@Url.Action("ListLaunchStatus", "Home")',
                dataType: 'JSON',
                success: function (response) {
                    if (response.status == "error") {
                        $("#section_error").html(RenderError(response.errorcode, response.errormsg.toString(), response.errorsrc.toString()));
                    }
                    else {
                        var responseArr = JSON.parse(response.toString());
                        //Create option for each retrieved
                        for (i = 0; i < responseArr.length; i++) {
                            //if (i != 5) {
                                $("#select_item_launchstatus").append('<option value= "' + responseArr[i].Value + '">' + responseArr[i].Text + '</option>');
                            //}

                        }
                        $("#select_item_launchstatus").selectpicker({
                            noneSelectedText: 'All Statuses' 
                        });
                        $("#select_item_launchstatus").selectpicker("refresh");
                    }
                },
                error: function (request, status, error) {
                    alert('Error occured');
                    alert(request.responseText);
                }
            });
        }
    </script>

}